---
phase: 47-documentation-update
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - docs/mcp-configuration.md
autonomous: true

must_haves:
  truths:
    - "README quick-start is 3 steps: docker compose up, index, use via MCP"
    - "README leads with MCP registration as primary use case, CLI as secondary"
    - "README has a Documentation section linking to every doc in docs/"
    - "MCP config doc does NOT include COCOSEARCH_DATABASE_URL in recommended examples"
    - "All examples use uvx cocosearch (not uv run)"
    - "No output blocks remain in either file"
    - "No references to port 3000, Python in Docker, or all-in-one Docker running MCP"
  artifacts:
    - path: "README.md"
      provides: "Project entry point with quick-start, features, setup, MCP registration, docs links"
      contains: "docker compose up"
    - path: "docs/mcp-configuration.md"
      provides: "Complete MCP registration guide for Claude Code, Claude Desktop, OpenCode"
      contains: "uvx --from git+https://github.com/VioletCranberry/coco-s cocosearch mcp"
  key_links:
    - from: "README.md"
      to: "docs/mcp-configuration.md"
      via: "inline link in MCP section"
      pattern: "\\./docs/mcp-configuration\\.md"
    - from: "README.md"
      to: "docs/cli-reference.md"
      via: "inline link in Documentation section"
      pattern: "\\./docs/cli-reference\\.md"
    - from: "README.md"
      to: "docs/architecture.md"
      via: "inline link in Documentation section"
      pattern: "\\./docs/architecture\\.md"
---

<objective>
Rewrite README.md and docs/mcp-configuration.md to accurately reflect the infra-only Docker model, optional DATABASE_URL defaults, and protocol enhancements.

Purpose: These are the two highest-visibility docs and the first things new users see. They must present a clean 3-step quick-start and simplified MCP registration without unnecessary environment variables.

Output: Updated README.md and docs/mcp-configuration.md reflecting current system state.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/47-documentation-update/47-CONTEXT.md
@.planning/phases/47-documentation-update/47-RESEARCH.md
@README.md
@docs/mcp-configuration.md
@docker-compose.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README.md</name>
  <files>README.md</files>
  <action>
Rewrite README.md following the target structure from RESEARCH.md. Key changes:

**Structure (in this order):**
1. `# CocoSearch` -- tagline: "Hybrid search for codebases -- semantic understanding meets keyword precision. Everything runs locally." Include the Cocoindex attribution line.
2. `## Quick Start` -- exactly 3 steps:
   - Step 1: `docker compose up -d` (start infrastructure)
   - Step 2: `uvx --from git+https://github.com/VioletCranberry/coco-s cocosearch index .` (index your project)
   - Step 3: Register MCP with `claude mcp add --scope user cocosearch -- uvx --from git+https://github.com/VioletCranberry/coco-s cocosearch mcp --project-from-cwd`
   - Brief note: "No environment variables needed -- defaults match Docker credentials."
3. `## Features` -- keep existing bullet list (hybrid search, symbol filtering, context expansion, query caching, index observability, privacy, AI assistant integration). Add parse health tracking bullet.
4. `## Supported Languages` -- keep existing content but use `uvx cocosearch languages` command example
5. `## Components` -- keep existing 3 components (Ollama, PostgreSQL+pgvector, CocoSearch)
6. `## Setup` with subsections:
   - `### Docker Compose (Recommended)` -- `docker compose up -d`, explain what it starts (PostgreSQL 17 with pgvector on 5432, Ollama with nomic-embed-text on 11434)
   - `### Manual Setup (Alternative)` -- brief mention of running PostgreSQL and Ollama manually, no detailed instructions
7. `## Using CocoSearch` with subsections:
   - `### MCP Registration (Recommended)` -- single registration command for Claude Code with uvx git+https pattern. Mention Claude Desktop and link to mcp-configuration.md for all options.
   - `### CLI` -- basic examples: `uvx cocosearch index /path/to/project`, `uvx cocosearch search "query" --pretty`, `uvx cocosearch stats --pretty`
8. `## Configuration` -- keep .cocosearch.yaml example
9. `## Documentation` -- link to each doc in docs/:
   - [Architecture Overview](./docs/architecture.md)
   - [MCP Configuration](./docs/mcp-configuration.md)
   - [MCP Tools Reference](./docs/mcp-tools.md)
   - [CLI Reference](./docs/cli-reference.md)
   - [Retrieval Logic](./docs/retrieval.md)
   - [Search Features](./docs/search-features.md)
   - [Dogfooding](./docs/dogfooding.md)
10. `## Skills` -- keep existing 3 skills with links, add "See Extend Claude with skills" link
11. `## Disclaimer` -- move to bottom, keep brief

**Tone:** Friendly and conversational (like Vercel or Supabase docs). Pragmatic, task-oriented.

**Rules to follow:**
- NO output blocks anywhere (remove all "Expected output:", "Output:" blocks)
- NO `COCOSEARCH_DATABASE_URL` in any command example
- NO references to port 3000
- NO `docker build` commands (docker compose is the recommended path)
- NO `dev-setup.sh` reference in main flow
- NO `uv run` -- always use `uvx cocosearch`
- Assume Docker Desktop and uv/uvx are pre-installed
- Use `uvx --from git+https://github.com/VioletCranberry/coco-s cocosearch` for all uvx examples (this is the git+https install pattern)
- Cross-reference docs with inline links where natural (not "See Also" sections)
- Clear, descriptive section headers for GitHub sidebar navigation
- Fix broken links: `./docs/dogfooding.md.` and `./docs/search-features.md.` (remove trailing periods)
- Describe current state only -- no migration notes
  </action>
  <verify>
Read README.md and verify:
1. Quick Start has exactly 3 steps
2. No "Output:" or output blocks exist (grep for "Output:" and triple-backtick blocks that look like terminal output)
3. No COCOSEARCH_DATABASE_URL appears in commands
4. No port 3000 mentioned
5. No `uv run` anywhere
6. No `docker build` commands
7. Documentation section has links to all 7 docs
8. All links are valid (no trailing periods)
  </verify>
  <done>
README.md is a clean, 3-step quick-start entry point. Docker compose is primary setup. MCP registration leads usage section. All commands use uvx. No output blocks. Documentation section links to all docs.
  </done>
</task>

<task type="auto">
  <name>Task 2: Rewrite docs/mcp-configuration.md</name>
  <files>docs/mcp-configuration.md</files>
  <action>
Rewrite docs/mcp-configuration.md following the target structure from RESEARCH.md. Key changes:

**Structure:**
1. `## Configuring MCP` -- intro paragraph explaining what MCP provides
2. `### Prerequisites` -- `docker compose up -d`, note that DATABASE_URL defaults to match Docker credentials so no env vars needed
3. `### Available MCP Tools` -- brief list of 5 tools (keep existing)
4. `### Single Registration (Recommended)` -- Claude Code single registration with:
   ```bash
   claude mcp add --scope user cocosearch -- \
     uvx --from git+https://github.com/VioletCranberry/coco-s cocosearch mcp --project-from-cwd
   ```
   Explain `--scope user` and `--project-from-cwd`. Mention that Claude Code supports MCP Roots capability so project detection is automatic.
5. `### Claude Desktop` -- JSON config using uvx pattern:
   ```json
   {
     "mcpServers": {
       "cocosearch": {
         "command": "uvx",
         "args": ["--from", "git+https://github.com/VioletCranberry/coco-s", "cocosearch", "mcp", "--project-from-cwd"]
       }
     }
   }
   ```
   Include config file locations (macOS, Linux, Windows). Note that Claude Desktop does not support Roots, so it falls back to `--project-from-cwd` for project detection.
6. `### OpenCode` -- JSON config using uvx pattern:
   ```json
   {
     "$schema": "https://opencode.ai/config.json",
     "mcp": {
       "cocosearch": {
         "type": "local",
         "command": ["uvx", "--from", "git+https://github.com/VioletCranberry/coco-s", "cocosearch", "mcp", "--project-from-cwd"],
         "enabled": true
       }
     }
   }
   ```
   Note OpenCode config differences (type, command as array, enabled flag).
7. `### Custom Database Connection` -- brief section explaining that DATABASE_URL defaults to `postgresql://cocosearch:cocosearch@localhost:5432/cocosearch`. Only set `COCOSEARCH_DATABASE_URL` if connecting to a different PostgreSQL instance. Show how to pass env in Claude Code (`--env COCOSEARCH_DATABASE_URL=...`) and in JSON config (`"env": {...}`).
8. `### Project Detection` -- explain the priority chain: MCP Roots (Claude Code) > `--project-from-cwd` > environment variable > current working directory. Mention HTTP transport `?project=` query parameter for programmatic use.

**Rules to follow:**
- NO `COCOSEARCH_DATABASE_URL` in the recommended (Docker) examples -- only in the "Custom Database Connection" section
- NO `uv run --directory` pattern -- always use `uvx --from git+https://...`
- NO `/absolute/path/to/cocosearch` placeholders -- the git+https pattern eliminates these
- NO output blocks
- NO "all-in-one Docker image" references
- Remove the "Per-Project Registration" section header if it was just about using `uv run --directory` (this is replaced by the single registration pattern)
- Remove per-project Claude Code "Option A" and "Option B" sections (replaced by single registration)
- Friendly, conversational tone
- Clear section headers for GitHub sidebar navigation
  </action>
  <verify>
Read docs/mcp-configuration.md and verify:
1. No COCOSEARCH_DATABASE_URL in recommended examples (only in Custom Database Connection section)
2. No `uv run` anywhere
3. No `/absolute/path/to/cocosearch` placeholders
4. No output blocks
5. No "all-in-one Docker image" references
6. Claude Code, Claude Desktop, and OpenCode configs all use uvx git+https pattern
7. Project detection priority chain is documented
  </verify>
  <done>
MCP configuration doc presents simplified setup: Docker compose for infra, uvx for registration, no env vars needed by default. All three clients (Claude Code, Claude Desktop, OpenCode) have clean config examples using uvx. Custom database connection is documented as an optional override. Project detection chain is explained.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `grep -r "uv run" README.md docs/mcp-configuration.md` returns no matches
2. `grep -r "port 3000\|:3000" README.md docs/mcp-configuration.md` returns no matches
3. `grep -r "docker build" README.md` returns no matches
4. `grep -r "Output:" README.md docs/mcp-configuration.md` returns no matches (no output blocks)
5. `grep -r "COCOSEARCH_DATABASE_URL" README.md` returns no matches (README should not show it)
6. All markdown links resolve (no trailing periods, no broken references)
</verification>

<success_criteria>
- README has a 3-step quick-start: docker compose up -> index -> MCP registration
- README Documentation section links to all 7 docs in docs/
- MCP config doc has clean examples for Claude Code, Claude Desktop, OpenCode without DATABASE_URL
- Both files use uvx cocosearch throughout
- No output blocks in either file
- No stale Docker model references (port 3000, all-in-one, Python in Docker)
</success_criteria>

<output>
After completion, create `.planning/phases/47-documentation-update/47-01-SUMMARY.md`
</output>
