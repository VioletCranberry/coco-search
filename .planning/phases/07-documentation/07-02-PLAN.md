---
phase: 07-documentation
plan: 02
type: execute
wave: 2
depends_on: [07-01]
files_modified: [README.md]
autonomous: true

must_haves:
  truths:
    - "User can configure CocoSearch as MCP server in Claude Code"
    - "User can configure CocoSearch in Claude Desktop"
    - "User can configure CocoSearch in OpenCode"
    - "Each MCP section includes verification steps"
    - "JSON configs use absolute paths (not ~)"
  artifacts:
    - path: "README.md"
      provides: "MCP configuration guides for all three clients"
      contains: ["## MCP Configuration", "Claude Code", "Claude Desktop", "OpenCode", "mcpServers"]
  key_links:
    - from: "README.md"
      to: "src/cocosearch/mcp/"
      via: "MCP server command"
      pattern: "cocosearch mcp"
---

<objective>
Add MCP configuration sections for Claude Code, Claude Desktop, and OpenCode to README.md.

Purpose: Enable users to integrate CocoSearch with their preferred MCP client.
Output: Three complete MCP configuration guides with copy-paste ready configs and verification steps.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-documentation/07-CONTEXT.md
@.planning/phases/07-documentation/07-RESEARCH.md
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Claude Code MCP configuration</name>
  <files>README.md</files>
  <action>
Add "## MCP Configuration" section to README.md after Installation. Start with Claude Code (MCP-01).

**Introduction paragraph**: Explain that CocoSearch provides an MCP server for semantic code search in LLM clients. Available tools: `index_codebase`, `search_code`, `list_indexes`, `get_stats`, `clear_index`.

**### Claude Code**

Option A - CLI (recommended):
```bash
claude mcp add --transport stdio --scope user \
  --env COCOINDEX_DATABASE_URL=postgresql://cocoindex:cocoindex@localhost:5432/cocoindex \
  cocosearch -- uv run --directory /absolute/path/to/cocosearch cocosearch mcp
```

Note: Replace `/absolute/path/to/cocosearch` with actual path. Use `pwd` in the cocosearch directory to get it.

Verify:
```bash
claude mcp list
```

Option B - JSON config (`~/.claude.json`):
```json
{
  "mcpServers": {
    "cocosearch": {
      "command": "uv",
      "args": ["run", "--directory", "/absolute/path/to/cocosearch", "cocosearch", "mcp"],
      "env": {
        "COCOINDEX_DATABASE_URL": "postgresql://cocoindex:cocoindex@localhost:5432/cocoindex"
      }
    }
  }
}
```

**Verification steps**:
1. Restart Claude Code (or run `/mcp` command)
2. Run `/mcp` to see cocosearch listed with status "connected"
3. Ask Claude to "search for authentication logic in my codebase"

IMPORTANT: Use absolute paths in JSON (JSON doesn't expand ~). Add explicit note about this.
  </action>
  <verify>grep -A 40 "### Claude Code" README.md shows CLI and JSON config options with verification</verify>
  <done>Claude Code MCP configuration section complete with both CLI and JSON options</done>
</task>

<task type="auto">
  <name>Task 2: Add Claude Desktop and OpenCode MCP configurations</name>
  <files>README.md</files>
  <action>
Add Claude Desktop (MCP-02) and OpenCode (MCP-03) configuration sections.

**### Claude Desktop**

Config file locations:
- **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
- **Linux**: `~/.config/Claude/claude_desktop_config.json`
- **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`

Config content:
```json
{
  "mcpServers": {
    "cocosearch": {
      "command": "uv",
      "args": ["run", "--directory", "/absolute/path/to/cocosearch", "cocosearch", "mcp"],
      "env": {
        "COCOINDEX_DATABASE_URL": "postgresql://cocoindex:cocoindex@localhost:5432/cocoindex"
      }
    }
  }
}
```

**Verification**:
1. Restart Claude Desktop completely (quit and reopen)
2. Look for hammer icon in the chat input area
3. Click hammer to see "cocosearch" tools listed
4. Start a new conversation and ask Claude to search your codebase

**### OpenCode**

Config file locations:
- **Global**: `~/.config/opencode/opencode.json`
- **Project**: `opencode.json` in project root

Config content (note differences from Claude configs):
```json
{
  "$schema": "https://opencode.ai/config.json",
  "mcp": {
    "cocosearch": {
      "type": "local",
      "command": ["uv", "run", "--directory", "/absolute/path/to/cocosearch", "cocosearch", "mcp"],
      "enabled": true,
      "environment": {
        "COCOINDEX_DATABASE_URL": "postgresql://cocoindex:cocoindex@localhost:5432/cocoindex"
      }
    }
  }
}
```

**Key differences from Claude configs** (add as note):
- Uses `"type": "local"` (not implicit)
- `command` is an array (not separate command/args)
- Uses `"environment"` (not `"env"`)
- Has explicit `"enabled": true`

**Verification**:
1. Restart OpenCode
2. Check MCP status in OpenCode settings/status
3. Verify cocosearch tools are available

Add note at end of MCP section: "Remember to replace `/absolute/path/to/cocosearch` with the actual path where you cloned the repository."
  </action>
  <verify>grep -A 30 "### Claude Desktop" README.md && grep -A 35 "### OpenCode" README.md shows both configs with verification steps</verify>
  <done>Claude Desktop and OpenCode MCP configurations complete with platform-specific paths</done>
</task>

</tasks>

<verification>
- [ ] "## MCP Configuration" section exists
- [ ] Claude Code section has CLI and JSON options
- [ ] Claude Desktop section has config paths for macOS/Linux/Windows
- [ ] OpenCode section highlights syntax differences
- [ ] All JSON configs use absolute paths (not ~)
- [ ] All sections have verification steps
- [ ] Database URL included in env/environment blocks
</verification>

<success_criteria>
User can:
1. Configure CocoSearch in Claude Code via CLI or JSON
2. Configure CocoSearch in Claude Desktop on any platform
3. Configure CocoSearch in OpenCode (global or project)
4. Verify each configuration works before using
</success_criteria>

<output>
After completion, create `.planning/phases/07-documentation/07-02-SUMMARY.md`
</output>
