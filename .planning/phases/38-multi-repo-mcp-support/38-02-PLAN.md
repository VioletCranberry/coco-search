---
phase: 38-multi-repo-mcp-support
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
autonomous: true

must_haves:
  truths:
    - "README documents Claude Code user-scope registration with --project-from-cwd"
    - "README documents Claude Desktop user-scope registration"
    - "Single-registration pattern is clearly explained"
    - "Examples show exact commands to run"
  artifacts:
    - path: "README.md"
      provides: "Multi-repo MCP registration documentation"
      contains: "--project-from-cwd"
  key_links:
    - from: "README.md"
      to: "claude mcp add"
      via: "registration commands"
      pattern: "claude mcp add.*--scope user"
---

<objective>
Document user-scope MCP registration patterns for Claude Code and Claude Desktop enabling single-registration multi-repo support.

Purpose: Users should be able to register CocoSearch once and use it across all their projects without re-registering per project.

Output: Updated README.md with clear single-registration documentation for both Claude Code and Claude Desktop.
</objective>

<execution_context>
@/Users/fedorzhdanov/.claude/get-shit-done/workflows/execute-plan.md
@/Users/fedorzhdanov/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/38-multi-repo-mcp-support/38-CONTEXT.md
@.planning/phases/38-multi-repo-mcp-support/38-RESEARCH.md
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document single-registration MCP pattern in README</name>
  <files>README.md</files>
  <action>
Find the MCP setup section in README.md and update it to show the single-registration pattern as the PRIMARY recommendation.

Add a new section "Single Registration (Recommended)" before the existing per-project patterns. Include:

**For Claude Code:**

```bash
# Register once for all projects (user scope)
claude mcp add --scope user cocosearch -- \
  uvx --from /absolute/path/to/cocosearch cocosearch mcp --project-from-cwd

# Verify registration
claude mcp list
```

**For Claude Desktop:**

Add to `~/Library/Application Support/Claude/claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "cocosearch": {
      "command": "uvx",
      "args": [
        "--from", "/absolute/path/to/cocosearch",
        "cocosearch", "mcp", "--project-from-cwd"
      ]
    }
  }
}
```

**Explanation section:**

- `--scope user` makes the registration available in ALL projects (not just current)
- `--project-from-cwd` tells CocoSearch to detect the project from whichever directory you're working in
- Open any project, CocoSearch automatically searches that project's index
- If the project isn't indexed yet, you'll get a prompt to index it

**For uvx users (pip/pipx alternative):**

```bash
# Register with uvx using git+https pattern
claude mcp add --scope user cocosearch -- \
  uvx --from git+https://github.com/user/cocosearch cocosearch mcp --project-from-cwd
```

Keep the existing per-project documentation but label it as "Per-Project Registration (Alternative)" and note that single-registration is preferred for most users.

Ensure the table of contents is updated if you add new section headers.
  </action>
  <verify>
1. README.md contains "Single Registration" section
2. Claude Code command includes `--scope user` and `--project-from-cwd`
3. Claude Desktop JSON config shows correct args array
4. Existing per-project docs still present but labeled as alternative
5. No broken markdown formatting
  </verify>
  <done>
README documents user-scope registration for Claude Code with exact command. README documents Claude Desktop JSON config. Single-registration pattern is clearly positioned as recommended approach.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add troubleshooting for unindexed project errors</name>
  <files>README.md</files>
  <action>
In the Troubleshooting section of README.md, add guidance for the "Index not found" error that users will see when searching an unindexed project:

**"Index not found" error:**

This error appears when you search a project that hasn't been indexed yet:

```
Error: Index not found
Project detected at /path/to/your-project but not indexed.
Index this project first using:
  CLI: cocosearch index /path/to/your-project
  MCP: index_codebase(path='/path/to/your-project')
```

**Solution:** Run the indexing command shown in the error message. With single-registration MCP, you can also ask Claude: "Please index this codebase first."

**"Index may be stale" warning:**

This warning appears when searching an index that hasn't been updated in over 7 days:

```
Warning: Index may be stale
Index last updated 12 days ago. Run `cocosearch index /path/to/project` to refresh.
```

**Solution:** Re-run the index command to pick up any code changes since the last index.
  </action>
  <verify>
1. Troubleshooting section contains "Index not found" guidance
2. Troubleshooting section contains "Index may be stale" guidance
3. Both include exact error messages users will see
4. Solutions are actionable and clear
  </verify>
  <done>
Troubleshooting section helps users understand and resolve unindexed project errors and staleness warnings.
  </done>
</task>

</tasks>

<verification>
1. README has "Single Registration (Recommended)" section
2. Claude Code user-scope command is documented with `--project-from-cwd`
3. Claude Desktop JSON config is documented with correct args array
4. Troubleshooting covers "Index not found" and staleness warnings
5. Documentation explains what happens when opening an unindexed project
</verification>

<success_criteria>
- Single-registration pattern is documented as primary recommendation
- Both Claude Code and Claude Desktop configurations shown
- Troubleshooting explains error messages users will encounter
- Documentation uses exact commands that will work
- Per-project registration preserved as alternative
</success_criteria>

<output>
After completion, create `.planning/phases/38-multi-repo-mcp-support/38-02-SUMMARY.md`
</output>
